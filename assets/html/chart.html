<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Chart.js Bar Chart</title>
    <style>
        ${style}
        .chart-container {
            width: ${chart_width}px;
            margin: 0 auto;
        }
    </style>
    <!-- Include Chart.js from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1>${title}</h1>
    <div class="chart-container">
        <canvas id="myChart" data-chart-ready="false"></canvas>
    </div>

    <!-- Plain JavaScript instead of TypeScript -->
    <script>
        // Wait for DOM and Chart.js to be ready, then render.
        function initChart() {
            if (!window.Chart) return false;
            const ctx = document.getElementById('myChart');
            if (!ctx) return false;
            const chartData = ${chart_data};

            // Disable animation for static image generation
            if (!chartData.options) chartData.options = {};
            chartData.options.animation = false;

            // Initialize the chart

            new Chart(ctx, chartData);
            requestAnimationFrame(() => {
                requestAnimationFrame(() => {
                    ctx.dataset.chartReady = "true";
                });
            });
            return true;
        }

        function waitForChart() {
            if (initChart()) return;
            setTimeout(waitForChart, 50);
        }

        document.addEventListener('DOMContentLoaded', function() {
            waitForChart();
        });
    </script>
</body>
</html>
